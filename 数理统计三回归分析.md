# 回归分析

[TOC]



# 一元线性回归

按着数理统计的方法，先做一些试验，分别给$x$以几个 不同的值$(x_1,x_2,\cdots,x_n)^T$,

假设其他条件不变，则相应地得到$n$个$Y$的观测值$(y-1，y_2,\cdots,y_n)$,

**一般$Y$可设为随机变量**，在此基础上寻求它们之间的关系$Y=f(x,\epsilon)$，这里$\epsilon$为随机变量（通常表示误差），$f$为未知函数。









## 一元线性回归模型

当$f$为线性函数即随机变量$Y$和可控制变量$x$服从线性关系，且$\epsilon\sim N(0,\sigma^2)$时，数学模型为
$$
Y=\alpha + \beta x +\epsilon
$$
设$(Y_i,x_i)(i=1,2,\cdots,n)$是 $(Y,x)$的$n$个观测值，则它们满足关系
$$
Y_i=\alpha + \beta x_i +\epsilon_i ,i=1,\cdots,n
$$
同时假设$\epsilon_i$相互独立且$\epsilon_i \sim 	N(0,\sigma^2),i=1,\cdots,n$

称$Y$与$x$服从一元线性模型，或一元线性正态回归模型



## 参数估计

### 1 $(\alpha,\beta)$的最小二乘估计

$$
\hat{\alpha} = \bar{Y} - \hat{\beta} \bar{x} \\
\hat{\beta} = \frac{\sum_{i=1}^n(x_i -\bar{x})(Y_i-\bar{Y})}{\sum_{i=1}^n(x_i -\bar{x})^2}
$$

### 2  $(\alpha,\beta)$的最大似然估计



### 3 $\sigma^2$的估计

把$\alpha,\beta$的估计量带入
$$
\hat{\sigma^2} = \frac{1}{n} \sum_{i=1}^n [Y_i - (\hat{\alpha}+\hat{\beta}x) ]\\
= \frac{1}{n} \sum_{i=1}^n (Y_i - \bar{Y})^2 - \hat{\beta}^2[ \frac{1}{n}\sum_{i=1}^n(x_i - \bar{x})^2]
$$

## 估计量的分布

### 1 $\hat{\beta}$的分布

$$
\hat{\beta} \sim N(\beta , \frac{\sigma^2}{\sum_{i=1}^n(x_i-\bar{x})^2})
$$



### 2 $\hat{\alpha}$的分布

$$
\hat{\alpha} \sim
N(\alpha,[\frac{(\bar{x})^2}{\sum_{i=1}^n(x_i - \bar{x})^2}]\sigma^2)
$$

### 3  对于 $x= x_0$，$\hat{Y_0} = \hat{\alpha} +\hat{\beta}x_0$的分布

$$
\hat{Y_0} \sim
N(\alpha+\beta x_0  ,[\frac{1}{n}+\frac{(x_0-\bar{x})^2}{\sum_{j=1}^n(x_j-\bar{x})^2}]\sigma^2 )
$$

### 4 $\hat{\sigma^2}$的分布

$$
\hat{\sigma^*}^2 = \frac{1}{n-2} \sum[Y_i - (\hat{\alpha}+\hat{\beta }x_i)]^2 \\
 
 E(\hat{\sigma^*}^2) = \sigma^2
$$



## 假设检验

假设：$H_0:\beta = 0$

统计量
$$
T = \frac{\hat{\beta} \sqrt{\sum_{i=1}^n(x_i-\bar{x})^2}}{\hat{\sigma^*}}
$$
拒绝域 ： $|t| \geq t_{\frac{\alpha}{2}}(n-2)$





# 多元线性回归



## 多元线性回归模型

随机变量$Y$与非随机变量$x_1,x_2,\cdots,x_m$之间的关系，假设具有线性关系
$$
Y = \beta_0 +\beta_1 x_1 +\cdots +\beta_mx_m +\epsilon \\
\epsilon \sim N(0,\sigma^2) ,m>1 ,\\
\beta_0,\beta_1,\cdots,\beta_m,\sigma^2\text{都是未知参数}
$$
一般称$x_1,\cdots,x_m$为回归变量，$\beta_0,\cdots,\beta_m$为回归系数

设$(x_{i1},x_{i2},\cdots,x_{im},Y_i)^T(i=1,2,\cdots,n)$是$(x_{1},x_{2},\cdots,x_{m},Y)^T$的$n$个观测

引入向量矩阵记号
$$
\symbf{Y}= (Y_1,Y_2,\cdots,Y_n)^T , \boldsymbol{\beta} =(\beta_0,\beta_1,\cdots,\beta_m)^T ,
\boldsymbol {\epsilon}=(\epsilon_1,\epsilon_2,\cdots,\epsilon_n)^T \\
\symbf{X} = 

\left [
  \begin{matrix}
   1 &x_{11} & x_{12} & \cdots & x_{1m}   \\
   1 &x_{21} & x_{22} & \cdots & x_{2m}   \\
   \vdots    & \vdots   & \vdots &  & \vdots  \\
   1 &xa_{n1} & x_{n2} & \cdots & x_{mn}  \\
  \end{matrix} 
\right
]_{(n,m+1)} \\
\symbf{Y} = \symbf{X}   \boldsymbol{\beta} + \boldsymbol {\epsilon} \\
E \symbf{Y}  = \symbf{X} \boldsymbol{\beta} \\
Cov(\symbf{Y},\symbf{Y})=E(\symbf{Y}-E\symbf{Y})(\symbf{Y}-E\symbf{Y})^T= \sigma^2\symbf{I}_n \\
\symbf{I}_n \text{为单位阵}
$$

## 参数估计

 $\boldsymbol{\beta}$的估计
$$
\boldsymbol{\beta} = (\symbf{X}^T\symbf{X})^{-1}\symbf{X}^T \symbf{Y}
$$
由此出发，可对$Y$进行预测



## 估计量的分布



### $ \hat{\boldsymbol{\beta} }$的分布

- 性质1 

  $ \hat{\boldsymbol{\beta} }$是$Y$的线性函数，服从$m+1$维正态分布，均值$E \hat{\boldsymbol{\beta} } = \boldsymbol{\beta} $，协方差阵为 $\sigma^2  (\symbf{X}^T\symbf{X})^{-1}$



- 性质2 

  $ \hat{\boldsymbol{\beta} }$是 $ \boldsymbol{\beta} $的最小方差无偏估计

- 



### $Z = A  \hat{\boldsymbol{\beta} }$  的分布

$$
E(Z) = A  \boldsymbol{\beta} \\
D(Z) = A Cov(\hat{ \boldsymbol{\beta}},\hat{ \boldsymbol{\beta}}) A^T \\
=A \sigma^2 (\symbf{X}^T\symbf{X})^{-1} A^T \\
= \sigma^2 A(\symbf{X}^T\symbf{X})^{-1} A^T \\
Z \sim N(A\boldsymbol{\beta},\sigma^2 A(\symbf{X}^T\symbf{X})^{-1} A^T )
$$





### 残差向量$\widetilde{\symbf{Y} }= \symbf{Y}  - \symbf{X} \hat{\boldsymbol{\beta}}$的分布

- 性质3 

  $\widetilde{\symbf{Y} }$和$\hat{}$$\boldsymbol{\beta}$互不相关,相互独立

- 性质4 

  $ \hat{\boldsymbol{\beta} }$是$Y$的服从$m+1$维正态分布，

  均值$E \widetilde{\symbf{Y} }  = \symbf{0} $，

  协方差阵为$Cov(\widetilde{\symbf{Y} },\widetilde{\symbf{Y} })=\sigma^2[I_n- \symbf{X}(\symbf{X}^T\symbf{X})^{-1} \symbf{X}^T] $ 





### $\hat{\sigma^2}$的分布

残差平方和 $Q =  \widetilde{\symbf{Y} } ^T \widetilde{\symbf{Y} } = ||\widetilde{\symbf{Y} }||^2$
$$
E(Q) = \sigma^2 (n-m-1) \\
E {\sigma^*}^2  = \frac{EQ}{n-m-1} = \sigma^2
$$

$$
\frac{(n-m-1)\hat{\sigma^*}^2}{\sigma^2} \sim \chi^2(n-m-1)
$$


## 假设检验

当$m=2$即 $Y = \beta_0 +\beta_1 x_1  +\beta_2x_2 +\epsilon $

且$\beta_0$已知 $\beta_0 =1$



假设：$H_0: a\beta_1 = b \beta_2$

统计量
$$
令 Z = a \hat{\beta_1} - b \hat{\beta_2} = [a,b][ \hat{\beta_1},\hat{\beta_2}]^T = A \hat{\beta} \\
E(Z) =  A \beta \\
D(Z) = A Cov(\hat{ \boldsymbol{\beta}},\hat{ \boldsymbol{\beta}}) A^T \\
=A \sigma^2 (\symbf{X}^T\symbf{X})^{-1} A^T \\
= \sigma^2 A(\symbf{X}^T\symbf{X})^{-1} A^T \\
Z \sim N(A\boldsymbol{\beta},\sigma^2 A(\symbf{X}^T\symbf{X})^{-1} A^T ) \\
U=\frac{Z -  A\beta}{ \sqrt{\sigma^2 A(\symbf{X}^T\symbf{X})^{-1} A^T}} \sim N(0,I) \\

V = \frac{(n-m-1)\hat{\sigma^*}^2}{\sigma^2} \sim \chi^2(n-m-1) \\
T = \frac{U}{\sqrt{V/(n-m-1)}} \sim t(n-m-1)
$$
拒绝域 
$$
|T| \geq t_{\frac{\alpha}{2}}(n-m-1)
$$
