# 贝叶斯估计

[TOC]



# 1 后验分布

- 对于给定$\theta$ , $X$的条件概率为$f(x|\theta)$

  所以$(x_1,x_2,\cdots,x_n)^T$的条件概率为
  $$
  q(x|\theta) = 
  \Pi_{i=1}^n f(x|\theta)
  $$
  
- $\theta$的先验分布为
  $$
  \pi (\theta)
  $$
  
- 则$(x_1,x_2,\cdots,x_n)^T$与$\theta$的联合概率分布为
  $$
  f(x,\theta) = q(x|\theta)\pi(\theta)
  $$
  
- $(X,\theta)$关于样本$x$的边缘分布为
  $$
  m(x) = \sum_\theta  f(x,\theta) = \sum_\theta  q(x|\theta)\pi(\theta) \\
  =\int_\Theta  f(x,\theta)d\theta = \int_\theta  q(x|\theta)\pi(\theta) d\theta 
  $$
  
- 于是后验概率分布
  $$
  h(\theta|x) = \frac{f(x,\theta)}{m(x)} = \frac{q(x|\theta)\pi(\theta)}{m(x)}
  $$
  



# 2 给定损失函数下的贝叶斯估计

### 平方损失

设$\theta$的先验分布为$\pi(\theta)$和损失函数为$L(\theta,d) = (\theta-d)^2 $

则$\theta$的贝叶斯估计是
$$
d^*(x) = E(\theta|X=x) = \int_{\Theta} \theta h(\theta|x) d\theta
$$
其中$h(\theta|x)$为参数$\theta$的后验密度

则$f(\theta)$的贝叶斯估计
$$
d^*(x) = E(f(\theta)|X=x) = \int_{\Theta} f(\theta) h(\theta|x) d\theta
$$


### 加权平方损失

设$\theta$的先验分布为$\pi(\theta)$和损失函数为加权平方损失函数$L(\theta,d) = \lambda(\theta)(\theta-d)^2 $

则$\theta$的贝叶斯估计是
$$
d^*(x) = \frac{E[\lambda(\theta) \theta |x]}{E[ \theta |x]}
= \frac{\int_{\Theta} \lambda(\theta) \theta h(\theta|x) d\theta}{ \int_{\Theta} \theta h(\theta|x) d\theta}
$$


# 3 贝叶斯风险

### 风险函数

设样本空间为$\mathscr{X}$  ,损失函数为$L(\theta,d)$ ，$d(X)$为决策函数

决策函数$d(X)$的风险函数为
$$
R(\theta,d) = E_\theta[L(\theta,d(X))] = \int _{\mathscr{X}}L(\theta,d(x))q(x|\theta)dx
$$




### **决策函数$d$在给定先验分布$\pi(\theta)$下的贝叶斯风险**

$$
R_B(d) = E[R(\theta,d)] \\
= \int_\Theta R(\theta,d) \pi(\theta) d\theta
$$



当总体$X$和$\theta$都是连续型随机变量时
$$
R_B(d) = \int_\Theta R(\theta,d) \pi(\theta) d\theta  \\
=\int_\Theta \int_{\mathscr{X}}L(\theta,d(x))q(x|\theta) dx \pi(\theta) d\theta \\
=\int_\Theta \int_{\mathscr{X}}L(\theta,d(x))q(x|\theta) \pi(\theta) dxd\theta \\
=\int_\Theta \int_{\mathscr{X}}L(\theta,d(x))m(x)h(\theta|x)  dx d\theta  \\
=  \int_{\mathscr{X}} m(x) \{\int_\Theta L() h() d\theta\}dx
$$
当总体$X$和$\theta$都是离散型随机变量时
$$
R_B(d) = \sum_xm(x) \{ \sum_\theta L()h()\}
$$
